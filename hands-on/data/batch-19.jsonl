{"prompt": "How do I use FLOWROLL to get a trailing 3-month total?", "completion": "You would use the formula `FLOWROLL(LineItem, 3, \"BACKWARD\")` which computes the rolling sum by taking the current period and adding it to the previous two periods, giving you a trailing three-month total that updates for each period in your time range."}
{"prompt": "What does the Direction parameter do in FLOWROLL?", "completion": "The Direction parameter is a critical component that controls the orientation of the rolling window. When you specify \"BACKWARD\", the window looks at historical periods creating a trailing aggregation, whereas \"FORWARD\" creates a leading aggregation by looking at future periods relative to the current position."}
{"prompt": "Can you show me a basic DIMMATCH example?", "completion": "The fundamental syntax is `DIMMATCH(SourceLineItem, TargetDimension)`. This function performs structural alignment by taking the values from your source line item and mapping them to match the dimensional structure of your target dimension, enabling calculations across different dimensional contexts."}
{"prompt": "My FLOWROLL returns all zeros. What should I check?", "completion": "There are two primary factors to investigate: First, verify that your input LineItem actually contains non-zero values throughout the relevant time periods. Second, confirm that your PeriodCount specification doesn't exceed the number of available periods in your time dimension, as an oversized PeriodCount will prevent window formation and result in zero or blank outputs."}
{"prompt": "What happens if I set PeriodCount to 1 in FLOWROLL?", "completion": "Setting PeriodCount to 1 creates a degenerate case where each rolling window contains only the current period itself. This effectively makes FLOWROLL behave as an identity function, simply returning the original values without any aggregation across multiple periods, which generally isn't useful for rolling window analysis."}
{"prompt": "How do I align sales data to a different product hierarchy?", "completion": "You accomplish this using `DIMMATCH(Sales, TargetProductList)`, but it's essential to understand that this requires proper mapping relationships to be established between your source product hierarchy and the target hierarchy. Without these mapping relationships defined in your model, DIMMATCH won't know how to align the values and will return blanks or errors."}
{"prompt": "FLOWROLL gives blanks for the first 5 periods. Why?", "completion": "This occurs because those initial periods lack sufficient historical data to construct complete rolling windows. When you're using, for example, PeriodCount=6, the first period only has itself, the second has two periods, and so on. Since none of these have the full six periods required, FLOWROLL correctly returns blanks rather than incomplete calculations for the first five periods."}
{"prompt": "Can DIMMATCH work without a mapping table?", "completion": "DIMMATCH can operate without explicit mapping tables in specific scenarios where the source and target dimensions already possess direct structural compatibility through established parent-child hierarchical relationships. However, when dimensions lack this inherent structural connection, explicit mapping tables become necessary to define how values should be aligned between the two dimensional structures."}
{"prompt": "What's the syntax for a 12-period forward rolling sum?", "completion": "The correct specification is `FLOWROLL(LineItem, 12, \"FORWARD\")`. This creates a leading window that aggregates the current period together with the subsequent eleven periods, giving you a forward-looking twelve-period sum that's useful for planning scenarios where you need to understand upcoming aggregate demand or supply."}
{"prompt": "Why does DIMMATCH fail when aligning revenue to customer list?", "completion": "This failure typically indicates that your revenue dimension and customer list dimension lack the structural compatibility required for DIMMATCH to perform alignment. You need to verify that mapping relationships exist between these dimensions, either through direct hierarchical connections or through explicit mapping tables that define how revenue items correspond to customer list members."}
{"prompt": "How do I fix FLOWROLL when it returns unexpected values?", "completion": "Start your troubleshooting by verifying that your time periods are arranged in proper chronological sequence, as FLOWROLL depends on sequential ordering to construct valid rolling windows. Next, carefully review your PeriodCount specification to ensure it matches your intended window size - a mismatch here is a common source of unexpected results."}
{"prompt": "What does FLOWROLL return for incomplete windows?", "completion": "When FLOWROLL cannot construct a complete window due to insufficient periods being available either at the beginning or end of your time range, it returns blank values rather than attempting to calculate with partial windows. This design choice ensures that all rolling window calculations are based on consistent, complete data sets."}
{"prompt": "Can I use DIMMATCH on time dimensions?", "completion": "No, DIMMATCH is fundamentally designed to work with structural list dimensions and cannot be applied to time dimensions. The function operates on the basis of dimensional membership and mapping relationships, which are concepts that don't apply to the temporal domain. For time-based operations, you need to use time-specific functions like FLOWROLL instead."}
{"prompt": "How do I calculate a 6-month backward rolling average?", "completion": "The calculation requires two steps: first use `FLOWROLL(LineItem, 6, \"BACKWARD\")` to obtain the rolling six-month sum, then divide that result by 6 to convert the sum into an average. So your complete formula would be `FLOWROLL(LineItem, 6, \"BACKWARD\") / 6`, which gives you the mean value across the trailing six-month window."}
{"prompt": "DIMMATCH shows dimension errors. What's wrong?", "completion": "Dimension errors in DIMMATCH typically arise when either your source dimension or target dimension isn't properly defined within the model, or when these dimensions lack the necessary structural compatibility or explicit mapping specifications that DIMMATCH requires to perform the alignment operation. You'll need to verify the dimensional definitions and ensure appropriate mappings exist."}
{"prompt": "What happens if my time periods are out of order?", "completion": "FLOWROLL has an absolute requirement for chronologically ordered periods because it constructs rolling windows based on sequential position. When periods are out of order, the function cannot determine which periods should be included in each window, resulting in incorrect or meaningless rolling window calculations that don't reflect actual temporal patterns."}
{"prompt": "How do I map product SKUs to a regional hierarchy using DIMMATCH?", "completion": "This requires a two-step approach: First, you need to create a mapping table within your model that explicitly links individual product SKUs to their corresponding regional hierarchy members. Once this mapping infrastructure is in place, you can then use `DIMMATCH(SKUData, RegionList)` to perform the alignment, which will use your mapping definitions to distribute or aggregate SKU-level values to the regional structure."}
{"prompt": "Can FLOWROLL handle negative numbers?", "completion": "Yes, FLOWROLL treats negative numbers exactly the same as positive numbers in its rolling window calculations. Negative values are included in the summation just like positive values, which is appropriate for financial applications where you might have both debits and credits, or any other scenario where negative values carry legitimate business meaning."}
{"prompt": "Why does DIMMATCH return partial results?", "completion": "Partial results from DIMMATCH indicate that only some of your source items have defined mapping relationships to the target dimension. Items lacking these mapping definitions will return blanks in the output. To achieve complete alignment, you need to ensure that mapping relationships are established for all leaf-level members in your source dimension."}
{"prompt": "What's the minimum PeriodCount for FLOWROLL?", "completion": "The technical minimum value for PeriodCount is 1, as the function requires at least this value to execute without error. However, from a practical standpoint, PeriodCount values below 2 don't generate meaningful rolling window aggregations since they don't actually aggregate across multiple periods, making them of limited analytical value."}
{"prompt": "How do I troubleshoot DIMMATCH alignment issues?", "completion": "A systematic troubleshooting approach should begin with verifying structural compatibility between your source and target dimensions. Next, examine your mapping tables to confirm they're complete and accurate. Finally, ensure that all required hierarchical relationships are properly defined in your model. These three elements form the foundation that DIMMATCH depends on for successful alignment."}
{"prompt": "FLOWROLL results jump unexpectedly. What causes this?", "completion": "These discontinuities occur when significantly large values enter into or exit from the rolling window as it moves through time. Each time a large spike appears in or drops out of the window, the aggregate sum changes substantially, creating what appears as a jump in the trend. Investigating your input data for these spikes, gaps, or anomalies will help you understand the cause."}
{"prompt": "Can I use FLOWROLL on weekly data?", "completion": "Absolutely. FLOWROLL is designed to work with any form of sequential time periods, whether those are weeks, months, quarters, years, or even custom calendar definitions. The key requirement is that the periods must be sequential and chronologically ordered, but the granularity or type of period is flexible."}
{"prompt": "What does DIMMATCH do when dimensions don't match?", "completion": "When DIMMATCH encounters source and target dimensions that lack structural compatibility or defined mapping relationships, it returns blank values or generates dimension errors for the affected items. This behavior is intentional and correct - DIMMATCH won't attempt to force alignment when the necessary dimensional relationships aren't present."}
{"prompt": "How do I get a quarter-to-date total with FLOWROLL?", "completion": "You can use `FLOWROLL(LineItem, 3, \"BACKWARD\")` to compute quarterly rolling totals. When applied in a monthly model, this gives you one-month, two-month, and three-month totals that align to each month position within the quarter, effectively providing quarter-to-date accumulations as you progress through each quarter."}
{"prompt": "Why does DIMMATCH ignore some hierarchy levels?", "completion": "DIMMATCH requires explicit mapping definitions at every level of your hierarchy. When certain levels are ignored, it indicates that parent-child relationships or mapping entries are missing for those specific levels. You'll need to add these missing hierarchical relationships to ensure DIMMATCH can properly traverse and align across all levels of your dimensional structure."}
{"prompt": "What happens if I change Direction from BACKWARD to FORWARD?", "completion": "Changing the Direction parameter fundamentally alters which periods are included in each rolling window. BACKWARD creates trailing windows that look at historical data, while FORWARD creates leading windows that look at future data. This shift changes not just which periods are aggregated, but the entire analytical perspective from retrospective to prospective."}
{"prompt": "Can DIMMATCH align data across different models?", "completion": "No, DIMMATCH is constrained to operate within a single model boundary. It relies on internal structural relationships, hierarchical definitions, and mapping tables that exist within a specific model context. Cross-model dimensional alignment would require a different approach, typically involving data export, transformation, and import workflows."}
{"prompt": "FLOWROLL gives different results after reordering periods. Why?", "completion": "This happens because the order of periods directly determines which specific periods fall within each rolling window. When you reorder periods, you're changing the sequential relationships that FLOWROLL uses to construct its windows. To get correct rolling window calculations, you must maintain chronological ordering that reflects actual temporal progression."}
{"prompt": "How do I use DIMMATCH with filtered data?", "completion": "The correct approach is to apply DIMMATCH before filtering operations. This is because DIMMATCH operates on the complete dimensional structure to perform alignment, and then filtering can be applied to the aligned results. If you filter first and then try to apply DIMMATCH, the dimensional structure may be incomplete, leading to incorrect or unexpected alignment results."}
{"prompt": "What's the maximum PeriodCount I can use in FLOWROLL?", "completion": "There's no theoretical upper limit on PeriodCount from a syntax perspective. However, practically speaking, if you specify a PeriodCount that exceeds the number of available periods in your time dimension, FLOWROLL will be unable to construct any complete windows, resulting in blank values for all periods. So while there's no hard maximum, your effective limit is constrained by your available time range."}
{"prompt": "Why does DIMMATCH duplicate values across members?", "completion": "This value expansion behavior occurs when your target dimension contains child members below the level where mapping occurs. DIMMATCH automatically distributes or broadcasts values to all applicable child members in the target structure, which creates what appears as duplication. This is actually correct behavior for hierarchical dimensional structures where parent values need to be reflected across their children."}
{"prompt": "How do I calculate year-over-year rolling sums?", "completion": "For year-over-year rolling totals, use `FLOWROLL(LineItem, 12, \"BACKWARD\")` assuming your model uses monthly periods. This creates trailing twelve-month sums that represent full-year aggregations, allowing you to compare consistent twelve-month periods across different time points. This is particularly useful for year-over-year growth analysis and trend identification."}
{"prompt": "Can FLOWROLL work with fiscal calendars?", "completion": "Yes, FLOWROLL is compatible with fiscal calendar implementations, provided that your fiscal periods are properly defined and maintained in chronological sequential order within your model. The function doesn't distinguish between fiscal and calendar periods - it simply requires that whatever period structure you're using follows proper sequential ordering."}
{"prompt": "DIMMATCH returns blanks for new items. How do I fix this?", "completion": "New items return blanks because they lack the mapping relationship entries that DIMMATCH needs to perform alignment. To resolve this, you need to add explicit mapping entries for these new items in your mapping tables, establishing how they relate to the target dimension. Once these mappings are defined, DIMMATCH will be able to include the new items in its alignment operations."}
{"prompt": "What does FLOWROLL do at period boundaries?", "completion": "At the boundaries of your time range - both the beginning and the end - FLOWROLL encounters situations where complete windows cannot be formed because there aren't enough periods available. Rather than calculating with incomplete windows, FLOWROLL returns blank values for these boundary positions, ensuring that all non-blank results represent complete, consistent rolling window calculations."}
{"prompt": "How do I combine FLOWROLL and DIMMATCH in one formula?", "completion": "You can nest these functions by applying FLOWROLL first to create the rolling aggregation, then wrapping that result in DIMMATCH to perform dimensional alignment: `DIMMATCH(FLOWROLL(LineItem, 6, \"BACKWARD\"), TargetDim)`. This approach is useful when you need to calculate rolling totals and then align them to a different dimensional structure than your source data."}
{"prompt": "Why are my FLOWROLL values so large?", "completion": "Large FLOWROLL values are often a direct result of your PeriodCount specification. When you use a large PeriodCount, the rolling window encompasses many periods, and the cumulative sum naturally becomes proportionally larger. For example, a PeriodCount of 12 will produce values roughly twelve times larger than a PeriodCount of 1, assuming relatively stable input data."}
{"prompt": "Can DIMMATCH handle one-to-many relationships?", "completion": "Yes, DIMMATCH is designed to handle one-to-many mapping cardinalities. When a single source item maps to multiple target members, DIMMATCH will distribute the source value appropriately. Conversely, when multiple source items map to a single target member, DIMMATCH will aggregate them. The specific behavior depends on the structural relationship and hierarchy levels involved."}
{"prompt": "How do I get a 4-week rolling total?", "completion": "If your model is configured to use weekly time periods, you would use `FLOWROLL(LineItem, 4, \"BACKWARD\")` to calculate a four-week trailing total. This creates a rolling window that spans four weeks, providing a smoothed view of weekly data that's useful for identifying trends while filtering out week-to-week volatility."}
{"prompt": "DIMMATCH works in one direction but not the reverse. Why?", "completion": "This directional asymmetry suggests that your mapping relationships are defined unidirectionally rather than bidirectionally. If you need DIMMATCH to work in both directions - from dimension A to B and from B to A - you need to verify that mapping relationships are explicitly defined in both directions within your model structure."}
{"prompt": "What happens when FLOWROLL encounters missing periods?", "completion": "When missing periods exist within your time range, FLOWROLL cannot construct complete windows for positions where these gaps would fall within the rolling window. This breaks window continuity and causes FLOWROLL to return blank values for affected periods. The function requires a continuous, complete sequence of periods to operate correctly."}
{"prompt": "How do I align measures from different dimensionalities?", "completion": "To align measures that exist on different dimensional structures, you need to project them onto a common dimensional basis using `DIMMATCH(SourceMeasure, CommonDimension)`. This approach allows you to bring disparate measures into the same dimensional space, making them comparable and enabling combined calculations that wouldn't be possible with their original dimensional structures."}
{"prompt": "Can FLOWROLL smooth volatile data?", "completion": "Yes, FLOWROLL is an effective smoothing technique for volatile time series data. By using larger PeriodCount values, you create wider rolling windows that average out short-term fluctuations and noise, revealing the underlying trend. The larger the PeriodCount, the greater the smoothing effect, though at the cost of reduced responsiveness to recent changes."}
{"prompt": "Why does DIMMATCH fail after adding new hierarchy members?", "completion": "When you add new members to a hierarchy, those members initially lack the mapping relationship definitions that DIMMATCH requires for alignment operations. Until you add these new members to your mapping tables and establish their relationships to other dimensions, DIMMATCH cannot include them in alignment calculations and will return blanks for them."}
{"prompt": "How do I calculate a rolling 3-period sum for each region?", "completion": "Using `FLOWROLL(RegionalData, 3, \"BACKWARD\")` will automatically compute independent three-period rolling sums for each region in your dimensional structure. FLOWROLL maintains dimensional context, so it calculates separate rolling windows for each member of the region dimension without requiring any additional specification or iteration logic."}
{"prompt": "What's the difference between FORWARD and BACKWARD in FLOWROLL?", "completion": "The BACKWARD direction creates trailing windows that aggregate historical periods, which is useful for analyzing past performance and trends. The FORWARD direction creates leading windows that aggregate future periods, which is valuable for planning scenarios and understanding future aggregate commitments. These two directions provide different analytical perspectives on the same data."}
{"prompt": "DIMMATCH produces unexpected aggregations. What should I check?", "completion": "Unexpected aggregations in DIMMATCH typically occur when your target dimension is at a higher hierarchical level than your source dimension. When DIMMATCH maps from child to parent levels, it automatically aggregates the values. Review your target dimension structure to verify whether you're inadvertently mapping to parent levels when you intended to maintain detailed granularity."}
